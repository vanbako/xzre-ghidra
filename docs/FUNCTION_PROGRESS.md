# Function Reverse-Engineering Progress

Track deep-dives on exported functions the same way we do for structs. Work a five-function session, summarize what changed in metadata/notes, and bump the counter below so the next analyst knows where to focus. The batch groupings mirror AGENTS.md but shrink to roughly five related functions per session so you can queue smaller RE bursts.

## Workflow Notes

- Generate or refresh notes under `notes/` as you walk each session, then promote final names/comments into `metadata/functions_autodoc.json` and `metadata/xzre_locals.json`.
- Run `./scripts/refresh_xzre_project.sh` (or `--check-only`) after editing metadata so Ghidra/xzregh stay aligned.
- Log milestones in `PROGRESS.md` and cite the session ID so others can pick up the thread.
- Increment the `Review Count` for every function you materially improved; use the `Notes` column to summarize scope/date.

## Recommended Function Review Order

Each table below lists five-function sessions in the order we recommend tackling them. The final session in a category may contain fewer entries when the batch size is not divisible by five.

### Opcode Scanners & Pattern Utilities (`opco_patt`)

_Walk the x86 helpers first so every later pass can lean on consistent pattern-matching primitives._

| Session | Focus | Functions |
| --- | --- | --- |
| `OP1` | Decoder & entry markers | `100020_x86_decode_instruction`, `100AC0_is_endbr32_or_64`, `100B10_find_endbr_prologue`, `100BA0_find_function_bounds`, `100C90_find_rel32_call_instruction` |
| `OP2` | MOV/LEA pattern search | `100D40_find_riprel_mov_or_lea`, `100E00_find_riprel_mov`, `100EB0_find_lea_with_displacement`, `100F60_find_riprel_lea`, `10AC40_find_reg_to_reg_instruction` |
| `OP3` | Memory operand sweeps | `101020_find_string_lea_xref`, `101060_find_riprel_opcode_memref_ex`, `101120_find_riprel_ptr_lea_or_mov_load`, `101170_find_riprel_grp1_imm8_memref`, `102C60_find_riprel_mov_load_target_in_range` |
| `OP4` | ELF pointer & string crossovers | `102A50_elf_find_function_ptr_slot`, `102D30_elf_build_string_xref_table`, `1032C0_elf_find_encoded_string_xref_site` |

### ELF Introspection & Memory Utilities (`elf_mem`)

_Tackle the ELF walkers from containment → relocations → allocator/tls glue._

| Session | Focus | Functions |
| --- | --- | --- |
| `EL1` | Containment + parser entry | `101210_fake_lzma_free_noop`, `101240_elf_vaddr_range_has_pflags_impl`, `1013A0_elf_vaddr_range_has_pflags`, `1013B0_is_pt_gnu_relro`, `1013D0_elf_info_parse` |
| `EL2` | Symbol + allocator priming | `101880_elf_gnu_hash_lookup_symbol`, `101B00_elf_gnu_hash_lookup_symbol_addr`, `101B30_memmove_overlap_safe`, `101B80_fake_lzma_alloc_resolve_symbol`, `101B90_elf_rela_find_relative_slot` |
| `EL3` | Reloc walkers | `101C30_elf_relr_find_relative_slot`, `101DC0_elf_find_import_reloc_slot`, `101E60_elf_find_plt_reloc_slot`, `101E90_elf_find_got_reloc_slot`, `101EC0_elf_get_text_segment` |
| `EL4` | Segment/string queries | `101F70_elf_get_rodata_segment_after_text`, `1020A0_elf_find_encoded_string_in_rodata`, `102150_elf_get_writable_tail_span`, `1022D0_elf_vaddr_range_in_relro_if_required`, `102370_is_range_mapped_via_pselect` |
| `EL5` | TLS + function lookup | `102440_tls_get_addr_trampoline`, `102490_get_fake_lzma_allocator_blob`, `1024F0_get_elf_functions_table`, `103CE0_main_elf_resolve_stack_end_if_sshd`, `104030_init_cpuid_ifunc_entry_ctx` |
| `EL6` | Allocator/tls wrappers | `104060_get_fake_lzma_allocator` |

### SSHD Discovery & Sensitive Data Recon (`sshd_recon`)

_Progress from finding sshd to wiring in the mm hooks and decrypting payloads._

| Session | Focus | Functions |
| --- | --- | --- |
| `SR1` | Entry points & monitor fields | `102550_sshd_find_main_from_entry_stub`, `102FF0_sshd_find_monitor_field_slot_via_mm_request_send`, `103340_sshd_find_sensitive_data_base_via_krb5ccname`, `103680_sshd_find_sensitive_data_base_via_xcalloc`, `103870_sshd_score_sensitive_data_candidate_in_do_child` |
| `SR2` | Score aggregation + monitor discovery | `103910_sshd_score_sensitive_data_candidate_in_main`, `103990_sshd_score_sensitive_data_candidate_in_demote_sensitive_data`, `103D50_sshd_score_sensitive_data_candidate`, `103DB0_sshd_find_monitor_ptr_slot`, `105410_sshd_recon_bootstrap_sensitive_data` |
| `SR3` | Process vetting & socket plumbing | `1039C0_argv_dash_option_contains_lowercase_d`, `103A20_sshd_validate_stack_argv_envp_layout`, `107400_sshd_log_via_sshlogv`, `107BC0_sshd_find_socket_fd_by_shutdown_probe`, `107C60_sshd_get_monitor_comm_fd` |
| `SR4` | Runtime patching & payload flow | `107D50_sshd_patch_permitrootlogin_usepam_and_hook_authpassword`, `107DE0_sshd_install_mm_log_handler_hook`, `107EA0_payload_stream_validate_or_poison`, `107F20_sshbuf_extract_rsa_modulus`, `108270_sshd_monitor_cmd_dispatch` |
| `SR5` | Monitor message hooks | `108080_mm_answer_keyverify_send_staged_reply_hook`, `108100_mm_answer_authpassword_send_reply_hook`, `108EA0_mm_answer_keyallowed_payload_dispatch_hook`, `10A3A0_mm_log_handler_hide_auth_success_hook`, `108D50_payload_stream_decrypt_and_append_chunk` |

### Loader Hooks & Runtime Setup (`loader_rt`)

_Cover initialization, GOT math, link-map audits, then finish with runtime helpers._

| Session | Focus | Functions |
| --- | --- | --- |
| `LR1` | Init contexts & imports | `102770_restore_ldso_audit_state`, `1027D0_hooks_ctx_init_or_wait_for_shared_globals`, `102850_init_backdoor_shared_globals`, `102890_libcrypto_imports_ready_or_install_bootstrap`, `102B10_sshd_validate_log_handler_slots` |
| `LR2` | GOT math & symbol resolution | `103F60_cache_cpuid_gotplt_slot_index`, `103F80_seed_got_ctx_for_tls_get_addr_parse`, `103FA0_resolve_gotplt_base_from_tls_get_addr`, `104010_cache_got_base_offset_from_cpuid_anchor`, `104080_find_link_map_l_name_offsets` |
| `LR3` | Link-map walks | `104370_find_dl_naudit_slot`, `1045E0_resolve_libc_read_errno_imports`, `104660_scan_link_map_and_init_shared_libs`, `104A40_scan_shared_libraries_via_r_debug`, `104AE0_find_l_audit_any_plt_mask_and_slot` |
| `LR4` | Audit offsets & stage two | `104EE0_find_l_audit_any_plt_mask_via_symbind_alt`, `1051E0_resolve_ldso_audit_offsets`, `105830_backdoor_install_runtime_hooks`, `106F30_cpuid_ifunc_stage2_install_hooks`, `10A794_cpuid_ifunc_patch_got_for_stage2` |
| `LR5` | Entry + cpuid adaptations | `10A720_cpuid_ifunc_resolver_entry`, `10A800_get_cpuid_modified`, `10A700_cpuid_gcc`, `1074B0_count_null_terminated_ptrs`, `backdoor_hooks_data_blob` |
| `LR6` | C stdlib + IO helpers | `107030_strlen_unbounded`, `107050_strnlen_bounded`, `107080_fd_read_full`, `1070F0_fd_write_full`, `107170_pointer_array_has_null` |

### Crypto, Secret Data & Command Channel (`crypto_cmd`)

_Work from crypto primitives forward into the secret-data builders._

| Session | Focus | Functions |
| --- | --- | --- |
| `CC1` | Crypto primitives | `103B80_dsa_pubkey_sha256_fingerprint`, `107190_chacha20_decrypt`, `1072B0_sha256_digest`, `107320_bignum_mpint_serialize`, `107510_rsa_pubkey_sha256_fingerprint` |
| `CC2` | Signature checks & sshbuf helpers | `107630_verify_ed448_signed_payload`, `107A20_sshd_find_forged_modulus_sshbuf`, `107920_sshbuf_is_negative_mpint`, `107950_sshbuf_extract_ptr_and_len`, `1081D0_secret_data_decrypt_with_embedded_seed` |
| `CC3` | Backdoor RSA hooks | `1094A0_rsa_backdoor_command_dispatch`, `10A240_rsa_public_decrypt_backdoor_shim`, `10A2D0_evp_pkey_set1_rsa_backdoor_shim`, `10A330_rsa_get0_key_backdoor_shim`, `10A860_popcount_u64` |
| `CC4` | Secret data appenders I | `10A880_encoded_string_id_lookup`, `10A990_secret_data_append_opcode_bit`, `10AA00_secret_data_append_code_bits`, `10AAC0_secret_data_append_singleton_bits`, `10AB70_secret_data_append_item_if_enabled` |
| `CC5` | Secret data appenders II | `10AB90_secret_data_append_bits_from_addr_or_ret`, `10ABC0_secret_data_append_bits_from_call_site`, `10ABE0_secret_data_append_items_batch` |

## Function Progress Tracker

Update this table whenever you finish a session. Keep the latest pass at the top of each note so new work is easy to skim.

| Function | Batch | Review Count | Notes |
| --- | --- | --- | --- |
| `100020_x86_decode_instruction` | `opco_patt` | 3 | 2025-12-16 (OP1 revisit) – simplified the decoder/prefix wipe cursor arithmetic, renamed `bVar2` to `cursor_byte`, added inline anchors for the VEX prefix and ModRM decode, and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (OP revisit) – replaced the lingering `undefined*` wipe/write casts with typed `u32` rewrites and added the inline note that explains how the operand-size override swaps the immediate width; 2025-11-21 (OP1) – expanded AutoDoc and renamed the imm/modrm helpers so the decoder locals read cleanly. |
| `100AC0_is_endbr32_or_64` | `opco_patt` | 1 | 2025-11-21 (OP1) – clarified the CET mask semantics and renamed the single bool to `has_endbr`. |
| `100B10_find_endbr_prologue` | `opco_patt` | 3 | 2025-12-16 (OP1 revisit) – simplified the scratch decoder wipe cursor arithmetic and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (OP revisit) – converted the scratch-context wipe to a typed `u32` rewrite so the exported C no longer shows `undefined4` casts; 2025-11-21 (OP1) – documented the ENDBR+alignment path and retagged the ctx zeroing cursor. |
| `100BA0_find_function_bounds` | `opco_patt` | 1 | 2025-11-21 (OP1) – refreshed the backward/forward scan summary; `local_40` scratch still needs a future rename. |
| `100C90_find_rel32_call_instruction` | `opco_patt` | 3 | 2025-12-16 (OP1 revisit) – simplified the scratch decoder wipe cursor arithmetic and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (OP revisit) – rewrote the ctx wipe loop through the metadata replacements so the auto-generated C loses the `undefined4` casts; 2025-11-21 (OP1) – wrote up the telemetry+call-target logic and renamed the scratch ctx zeroing temps. |
| `100D40_find_riprel_mov_or_lea` | `opco_patt` | 3 | 2025-12-16 (OP2 revisit) – clarified the RIP-relative ModRM gate (`mod=0`, `rm=5`) + decoder opcode normalization (+0x80) in AutoDoc and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (OP revisit) – swapped the scratch-context wipe to a typed rewrite so the exported loop no longer emits `undefined4` and rechecked the metadata after regenerating; 2025-11-21 (OP2) – Documented the hybrid MOV/LEA filter, tied AutoDoc to the load/store + REX.W checks, and renamed the scratch decoder zeroing temps (`ctx_clear_idx/cursor`, `decoded_opcode`, `is_expected_opcode`). |
| `100E00_find_riprel_mov` | `opco_patt` | 3 | 2025-12-16 (OP2 revisit) – clarified the RIP-relative ModRM gate (`mod=0`, `rm=5`) + decoder opcode normalization (+0x80) in AutoDoc and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (OP revisit) – replaced the scratch decoder wipe with a typed `u32` store via the locals metadata so Ghidra’s `undefined4` casts disappear; 2025-11-21 (OP2) – MOV-only path now describes the byte-by-byte retry behaviour, enforces the load/store width constraint in doc, and adopts the same ctx zeroing/local names as the other pointer scanners. |
| `100EB0_find_lea_with_displacement` | `opco_patt` | 3 | 2025-12-16 (OP2 revisit) – clarified the opcode normalization (+0x80) used for LEA/CALL/MOV constants in AutoDoc and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (OP revisit) – forced the ctx wipe loop through the locals replacement path so the generated code stops emitting `undefined4` stores; 2025-11-21 (OP2) – Added the secret-data breadcrumb + ±displacement explanation and renamed the stack decoder wipe loop (`ctx_clear_idx/cursor`, `ctx_stride_sign`). |
| `100F60_find_riprel_lea` | `opco_patt` | 3 | 2025-12-16 (OP2 revisit) – clarified the RIP-relative disp32 ModRM requirement (`mod=0`, `rm=5`) + opcode normalization (+0x80) in AutoDoc and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (OP revisit) – used the locals metadata to rewrite the ctx wipe to `u32` stores so no `undefined4` fragments survive in the regenerated source; 2025-11-21 (OP2) – Clarified the optional RIP target comparison, the REX.W+ModRM requirements, and synced the scratch ctx locals/notes with the other LEA helpers. |
| `10AC40_find_reg_to_reg_instruction` | `opco_patt` | 2 | 2025-12-16 (OP2 revisit) – corrected the ALU opcode whitelist (ADD/OR/ADC/SBB/SUB/XOR/CMP) and documented the exact prefix/REX gates (`flags_u16 & 0xf80`, `rex_byte & 0x05`), then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-21 (OP2) – Wrote up the ModRM/prefix rejects, documented the arithmetic opcode bitmask, and renamed the temps to `decoded`/`opcode_lookup_index`. |
| `101020_find_string_lea_xref` | `opco_patt` | 3 | 2025-12-17 (OP3 revisit) – simplified the scratch decoder wipe pointer arithmetic via `metadata/xzre_locals.json` and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (OP revisit) – cleaned the scratch decoder wipe via metadata so the exported helper no longer leaks `undefined4` casts; 2025-11-22 (OP3) – Named the LEA hit/ctx wipe temps and documented how the helper returns the LEA site as the string xref anchor. |
| `101060_find_riprel_opcode_memref_ex` | `opco_patt` | 3 | 2025-12-17 (OP3 revisit) – clarified the RIP-relative ModRM gate (`mod=0`, `rm=5`) + `DF2_MEM_DISP` semantics, renamed `ctx_stride_selector` → `ctx_stride_sign`, and simplified the ctx-wipe stride expression via locals metadata before refreshing; 2025-11-27 (OP revisit) – pushed the ctx wipe rewrite into metadata so the regenerated decoder loop no longer emits `undefined4`; 2025-11-22 (OP3) – Captured the secret-data instrumentation, renamed the ctx stride controls, and added inline notes for the sliding window plus DF2/RIP predicate. |
| `101120_find_riprel_ptr_lea_or_mov_load` | `opco_patt` | 2 | 2025-12-17 (OP3 revisit) – updated the fallback doc to reference `X86_OPCODE_MOV_LOAD` and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-22 (OP3) – Clarified the LEA-vs-MOV handoff and inserted the inline comment that explains why the MOV predicate re-runs with opcode `0x10b`. |
| `101170_find_riprel_grp1_imm8_memref` | `opco_patt` | 3 | 2025-12-17 (OP3 revisit) – corrected the opcode write-up (`0x103` = raw `0x83` GRP1 imm8), clarified the RIP-relative ModRM/`DF2_MEM_DISP` requirements, and simplified the scratch ctx wipe pointer arithmetic before refreshing; 2025-11-27 (OP revisit) – removed the `undefined4` scratch wipe by teaching the locals metadata how to rewrite the zeroing loop; 2025-11-22 (OP3) – Synced the scratch decoder locals, documented the opcode `0x103` + ModRM requirements, and noted the optional RIP comparison inline. |
| `102C60_find_riprel_mov_load_target_in_range` | `opco_patt` | 3 | 2025-12-17 (OP3 revisit) – clarified the MOV-load (`X86_OPCODE_MOV_LOAD`) + ModRM/`DF2_MEM_DISP` semantics, fixed stale inline-match patterns so the REX.W gate comment re-applies, and simplified the scratch ctx wipe pointer arithmetic before refreshing; 2025-11-27 (OP revisit) – rewrote the scratch decoder zeroing loop via metadata so the MOV tracker no longer emits `undefined4`; 2025-11-22 (OP3) – Introduced `func_cursor/func_end`, described the 32-bit MOV/DF2 gating, and added inline commentary for the RIP-relative recompute and range test. |
| `102A50_elf_find_function_ptr_slot` | `opco_patt` | 1 | 2025-11-23 (OP4) – Documented the RELA/RELR slot hunt, renamed the slot/xref temps, and annotated the RELRO + ENDBR checks. |
| `102D30_elf_build_string_xref_table` | `opco_patt` | 3 | 2025-12-17 (OP4 revisit) – codified the `u8 *` pointer-math rewrites (text-end calc, next-instruction cursor, RIP targets) and fixed the `entry_cursor` typing so the exported C no longer emits `decode_cursor->instruction`/`decode_cursor->opcode_window` artifacts; refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (OP revisit) – routed the decoder wipe through metadata to eliminate `undefined4` and added a new inline anchor documenting that scratch reset before the `.text` walk; 2025-11-23 (OP4) – Clarified the catalogue builder loops, renamed the range/xref temps, and added inline notes for the rodata/text/reloc passes. |
| `1032C0_elf_find_encoded_string_xref_site` | `opco_patt` | 1 | 2025-11-23 (OP4) – Captured the telemetry gate + rodata walk, renamed the temps, and documented the LEA search inline. |
| `101210_fake_lzma_free_noop` | `elf_mem` | 1 | 2025-11-23 (EL1) – Clarified the bootstrap stub’s purpose and dropped an inline `return` comment so the fake allocator wiring is obvious. |
| `101240_elf_vaddr_range_has_pflags_impl` | `elf_mem` | 2 | 2025-12-17 (EL1 revisit) – rewrote the exported pointer arithmetic to use `u8 *` math (removed the `Elf64_Ehdr::e_ident` byte-pointer hacks), documented the wraparound guard in AutoDoc, and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-23 (EL1) – Renamed the recursion-depth/page-window locals and annotated the alignment + range-splitting paths for overlapping segments. |
| `1013A0_elf_vaddr_range_has_pflags` | `elf_mem` | 1 | 2025-11-23 (EL1) – Documented the wrapper role, added inline telemetry about passing work to the recursive helper, and confirmed the flag semantics. |
| `1013B0_is_pt_gnu_relro` | `elf_mem` | 1 | 2025-11-23 (EL1) – Captured the additive obfuscation for PT_GNU_RELRO and inserted an inline note explaining the wrapped constant. |
| `1013D0_elf_info_parse` | `elf_mem` | 3 | 2025-12-17 (EL1 revisit) – added inline AutoDoc anchors mapping the key DT_* dynamic tags (PLTRELSZ/JMPREL/RELR/RELRSZ/GNU_HASH/VERSYM/VERDEF) plus the `Elf64_Dyn` stride so the dynamic-table parser reads cleanly, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (EL6) – Replaced the ad-hoc `undefined*` vector scratchpads with named 128-bit counters, documented the RELRO uniqueness + `.gnu.version_d` gating inline, and refreshed the metadata so the wipe loop and relocation counts emit typed stores. |
| `101880_elf_gnu_hash_lookup_symbol` | `elf_mem` | 1 | 2025-11-23 (EL2) – renamed the GNU-hash bucket/chain/versym cursors, added telemetry + versym-walk inline comments, and refreshed the exported C so the secret-data breadcrumb plus version gating read clearly. |
| `101B00_elf_gnu_hash_lookup_symbol_addr` | `elf_mem` | 2 | 2025-12-17 (EL2 revisit) – rewrote the module-base add to use `(u8 *)elf_info->elfbase` (dropping the `Elf64_Ehdr::e_ident` byte-pointer hack) and refreshed; 2025-11-23 (EL2) – collapsed the misnamed temp to `sym_entry`, documented the defined-symbol gate + module-base addition inline, and re-synced the metadata so the stub mirrors `elf_gnu_hash_lookup_symbol`. |
| `101B30_memmove_overlap_safe` | `elf_mem` | 1 | 2025-11-23 (EL2) – retitled the reverse copy index and injected inline comments that spell out the backward- vs forward-copy paths. |
| `101B80_fake_lzma_alloc_resolve_symbol` | `elf_mem` | 1 | 2025-11-23 (EL2) – removed the unused locals, renamed the return temp to `symbol_addr`, and annotated that `opaque/size` are just `elf_info_t`+EncodedStringId indirection into `elf_gnu_hash_lookup_symbol_addr`. |
| `101B90_elf_rela_find_relative_slot` | `elf_mem` | 2 | 2025-12-17 (EL2 revisit) – fixed the prototype (`void *target_addr`, explicit bounds + `resume_index_ptr`) so call sites stop casting pointers and the decomp no longer emits CONCAT44 high-word temps; refreshed the exported pointer math to use `(u8 *)elfbase`; 2025-11-23 (EL2) – renamed the RELA cursor/resume/range temps, exposed the slot lower-bound parameter, and added inline comments covering the RELATIVE-only filter plus optional `[low, high]`/resume handling. |
| `101C30_elf_relr_find_relative_slot` | `elf_mem` | 2 | 2025-12-17 (EL3 revisit) – fixed the signature (`void *target_addr` + explicit bounds + `resume_index_ptr`) so call sites stop casting pointers and the decomp no longer emits CONCAT44 temps; codified the `Elf64_Ehdr::e_ident` byte-pointer hack as `(u8 *)elfbase` in locals metadata and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-23 (EL3) – renamed the RELR slot/bounds/resume temps and added inline comments for the literal vs. bitmap decoding paths plus the optional clamp. |
| `101DC0_elf_find_import_reloc_slot` | `elf_mem` | 2 | 2025-12-17 (EL3 revisit) – rewrote the returned relocation-slot pointer to `(u8 *)elf_info->elfbase + r_offset` via locals metadata (dropping the `Elf64_Ehdr::e_ident` byte-pointer hack) and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-23 (EL3) – documented the telemetry gate + undefined-symbol filter inline so the relocation sweep logic and writable-slot return path read clearly. |
| `101E60_elf_find_plt_reloc_slot` | `elf_mem` | 1 | 2025-11-23 (EL3) – captured the PLT feature-bit guard and the hand-off into `elf_find_import_reloc_slot` (R_X86_64_JUMP_SLOT) with inline notes; renamed the scratch slot pointer. |
| `101E90_elf_find_got_reloc_slot` | `elf_mem` | 1 | 2025-11-23 (EL3) – mirrored the RELA feature-bit requirements and inline commentary for the GOT flow (R_X86_64_GLOB_DAT) plus the slot temp rename. |
| `101EC0_elf_get_text_segment` | `elf_mem` | 1 | 2025-11-23 (EL3) – expanded the AutoDoc/inline notes around the telemetry breadcrumb, `.text` caching, and PT_LOAD alignment maths so the locals explain why the scan only runs once. |
| `101F70_elf_get_rodata_segment_after_text` | `elf_mem` | 1 | 2025-11-23 (EL4) – documented the secret-data gate and rodata caching, renamed the rodata cursor/size temps, and added inline breadcrumbs for the cache short-circuit plus the PF_R segment sweep. |
| `1020A0_elf_find_encoded_string_in_rodata` | `elf_mem` | 1 | 2025-11-23 (EL4) – captured the `stringId_inOut` semantics, renamed the rodata span buffer, and added inline comments for the telemetry gate, resume pointer clamp, and zero-id fast path. |
| `102150_elf_get_writable_tail_span` | `elf_mem` | 1 | 2025-11-23 (EL4) – renamed the selected-segment locals, expanded the AutoDoc around the PF_W scan + padding math, and annotated the cache hit, segment selection, and alignment branches inline. |
| `1022D0_elf_vaddr_range_in_relro_if_required` | `elf_mem` | 2 | 2025-11-23 (EL4) – refreshed the RELRO plate to cover the `p_flags` gate, renamed the relro window temps, and injected inline notes for the PF_R check plus the page-aligned RELRO clamp; 2025-12-17 (EL4 revisit) – corrected the PF_W containment semantics, renamed the boolean argument to `require_relro`, and reran the headless refresh so `xzregh/1022D0_elf_vaddr_range_in_relro_if_required.c` matches the updated metadata. |
| `102370_is_range_mapped_via_pselect` | `elf_mem` | 1 | 2025-11-23 (EL4) – rewrote the AutoDoc around the `pselect` probe, renamed the libc/import/time cursors, and annotated the low-address guard, import validation, probe call, and EFAULT bailouts inline. |
| `102440_tls_get_addr_trampoline` | `elf_mem` | 1 | 2025-11-23 (EL5) – renamed the lone register temp to `resolved_tls` and documented why this wrapper always jumps straight into glibc’s resolver while the trap stub handles relocations. |
| `102490_get_fake_lzma_allocator_blob` | `elf_mem` | 1 | 2025-11-23 (EL5) – spelled out the sentinel+offset trick, renamed the cursor/index temps, and added inline notes for the relocation-safe base pointer and 12-slot walk. |
| `1024F0_get_elf_functions_table` | `elf_mem` | 2 | 2025-12-17 (EL5 revisit) – corrected the AutoDoc plate to reference `fake_lzma_allocator_offset` (matching the decomp’s sentinel) and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-23 (EL5) – mirrored the relocation-safe pointer math for the helper vtable and annotated the sentinel start plus the 12-slot advance. |
| `103CE0_main_elf_resolve_stack_end_if_sshd` | `elf_mem` | 2 | 2025-12-17 (EL5 revisit) – rewrote the `__libc_stack_end` address computation to `(void **)((u8 *)elf->elfbase + st_value)` via locals metadata (dropping the `Elf64_Ehdr::e_ident` byte-pointer hack), updated the inline AutoDoc anchor, and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-23 (EL5) – clarified the ld.so parse, `__libc_stack_end` lookup, sshd verification, and pointer publish with inline comments tied to each step. |
| `104030_init_cpuid_ifunc_entry_ctx` | `elf_mem` | 2 | 2025-12-17 (EL5 revisit) – clarified `_Lrc_read_destroy` as the relocation-safe cpuid anchor in AutoDoc and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-23 (EL5) – documented every cpuid GOT prep write (random symbol, resolver-frame slot, GOT math, TLS reset) and added inline breadcrumbs for each field assignment. |
| `104060_get_fake_lzma_allocator` | `elf_mem` | 2 | 2025-12-17 (EL6 revisit) – corrected the AutoDoc plate/inline to reflect that callers patch `allocator->opaque` and use `lzma_alloc()`/`lzma_free()` as a symbol-resolver interface (via `fake_lzma_alloc_resolve_symbol`/`fake_lzma_free_noop`), then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (EL6) – wrapped the helper in a `plate+inline` AutoDoc, renamed `pfVar1` to `fake_allocator` via `metadata/xzre_locals.json`, and reran the refresh so the inline comments/locals rewrite landed in `xzregh/104060_get_fake_lzma_allocator.c`. |
| `102550_sshd_find_main_from_entry_stub` | `sshd_recon` | 3 | 2025-12-17 (SR1 revisit) – replaced the lingering `Elf64_Ehdr::e_ident` base-pointer math with explicit `(u8 *)elfbase` casts and simplified the decoder wipe cursor increment (`(u8 *)ctx_cursor + 4`) via `metadata/xzre_locals.json`, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (SR revisit) – rewrote the decoder wipe through the locals metadata so the zeroing loop emits typed `u32` stores and added an inline note explaining why the scratch context gets cleared up front; 2025-11-24 (SR1) – Renamed the anonymous ELF symbol temps, documented the allocator/libc bootstrap, and added inline notes for the LEA→`__libc_start_main` pattern so the entry hunt is readable. |
| `102FF0_sshd_find_monitor_field_slot_via_mm_request_send` | `sshd_recon` | 3 | 2025-12-17 (SR1 revisit) – cleaned up the decoder wipe cursor increment (`(u8 *)zero_ctx_cursor + 4`) so the exported C drops the `&...->instruction` cast, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (SR revisit) – converted the MOV/LEA context wipe to typed stores, hooked in an inline comment describing the reset, and reran the refresh so no `undefined4` casts linger; 2025-11-24 (SR1) – Captured the MOV/LEA seeding flow, the 0x40-byte tracking window, and the RDI→`mm_request_send` requirement via inline comments to make the register chase obvious. |
| `103340_sshd_find_sensitive_data_base_via_krb5ccname` | `sshd_recon` | 3 | 2025-12-17 (SR1 revisit) – cleaned up both decoder wipe cursors to use `(u8 *)zero_ctx_cursor + 4` (dropping the `&...->instruction`/`zero_seed` arithmetic), then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (SR revisit) – taught both decoder wipes to use `u32` stores and documented the dual zeroing passes inline so the environment-scan/state-machine dance remains readable; 2025-11-24 (SR1) – Expanded the AutoDoc for both getenv/LEA cases, renamed the tracker locals, and annotated the scan/stride math that proves the `.bss` stores. |
| `103680_sshd_find_sensitive_data_base_via_xcalloc` | `sshd_recon` | 3 | 2025-12-17 (SR1 revisit) – cleaned the store-hit reset (no more `(long *)` casts while walking the buffer), simplified the decoder wipe cursor math, and dropped the spurious `(long)` cast when recording store hits via `metadata/xzre_locals.json`, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (SR revisit) – forced the store-hit buffer and decoder wipes through the locals metadata (no more `undefined4` casts) and added inline notes calling out the array reset and context scrub; 2025-11-24 (SR1) – Clarified how the helper finds the xcalloc call, records each `.bss` store, and tests the ptr/ptr+8/ptr+0x10 triplet, with new inline breadcrumbs on the decoder loop. |
| `103870_sshd_score_sensitive_data_candidate_in_do_child` | `sshd_recon` | 3 | 2025-12-17 (SR1 revisit) – simplified the scratch wipe cursor math to `(u8 *)ctx_cursor + 4` (dropping the `zero_seed` multiplication) via `metadata/xzre_locals.json`, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (SR revisit) – rewired the shared decoder wipe to an explicit `u32` rewrite and annotated the inline comment so it’s obvious why the context is reset before counting +0x10 hits; 2025-11-24 (SR1) – Documented the score math (base + first/second +0x10 hits), renamed the context scratch, and dropped inline notes on each pass over `do_child`. |
| `103910_sshd_score_sensitive_data_candidate_in_main` | `sshd_recon` | 2 | 2025-12-17 (SR2 revisit) – corrected the `main()` scorer to a 0–3 field-hit count (`host_keys`/`host_pubkeys`/`host_certificates`), renamed the hit booleans accordingly, and refreshed the inline AutoDoc anchors; 2025-11-24 (SR2) – promoted the scoring helper to plate+inline form, renamed the base/+8/+0x10 hit flags, and added inline notes that explain how the signed score is derived. |
| `103990_sshd_score_sensitive_data_candidate_in_demote_sensitive_data` | `sshd_recon` | 2 | 2025-12-17 (SR2 revisit) – clarified the +3 heuristic as a reference to `&sensitive_data->host_keys` (struct base) and refreshed the plate/inline wording; 2025-11-24 (SR2) – captured the single-hit/three-point heuristic in metadata, added inline comments on the string-ref scan, and renamed the demote_hit/score temps. |
| `103D50_sshd_score_sensitive_data_candidate` | `sshd_recon` | 1 | 2025-11-24 (SR2) – rewrote the aggregator AutoDoc, added inline annotations for each heuristic call, and retitled the `score_*` register temps to match the exported C. |
| `103DB0_sshd_find_monitor_ptr_slot` | `sshd_recon` | 2 | 2025-12-17 (SR2 revisit) – corrected the monitor discovery docs to describe voting on the `.bss` slot stored in `ctx->monitor_struct_slot` (`monitor **`) and refreshed the helper-call inline anchor; 2025-11-24 (SR2) – documented the 10-function vote loop, renamed the candidate/vote cursors, and dropped inline comments describing the counter reuse and ≥5 votes gate. |
| `105410_sshd_recon_bootstrap_sensitive_data` | `sshd_recon` | 3 | 2025-12-17 (SR2 revisit) – replaced the lingering `Elf64_Ehdr::e_ident` base-pointer hack with explicit `(u8 *)libcrypto->elfbase + st_value` pointer math when resolving `EVP_DigestVerify`, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-25 (SR2 revisit) – documented the CET/NOP scan, `.data` span, and scoring threshold inline, renamed the lingering digest/libcrypto/segment temps, and refreshed the secret-data breadcrumb comments. |
| `1039C0_argv_dash_option_contains_lowercase_d` | `sshd_recon` | 1 | 2025-11-24 (SR3) – renamed the sliding-window temps, expanded the dash/debug AutoDoc, and added inline comments that explain the exit cases. |
| `103A20_sshd_validate_stack_argv_envp_layout` | `sshd_recon` | 3 | 2025-12-17 (SR3 follow-up) – fixed the envp cursor cast to `char **`, added an inline anchor for the envp start, and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-25 (SR3 revisit) – tightened the stack/envp AutoDoc, documented the `.bss` padding guard + NULL env rejection inline, and renamed the string_id/env cursor locals so the exported C highlights the 0x2c headroom rule. |
| `107400_sshd_log_via_sshlogv` | `sshd_recon` | 2 | 2025-12-17 (SR3 follow-up) – renamed the SysV varargs `AL` byte to `xmm_vararg_count`, renamed the empty file/func sentinel, clarified the sshlogv signature in AutoDoc, and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (SR3) – documented the SSE save + va_list rebuild, renamed the scratch regs, and added inline comments for the spill/tail-call points. |
| `107BC0_sshd_find_socket_fd_by_shutdown_probe` | `sshd_recon` | 2 | 2025-12-17 (SR3 follow-up) – clarified that the shutdown probe uses an intentionally invalid `how` to avoid mutating the socket and refreshed the inline wording for the `EINVAL/ENOTCONN` gate, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (SR3) – clarified the shutdown(EINVAL/ENOTCONN) probe, renamed the counter/errno scratch, and annotated the match/return logic inline. |
| `107C60_sshd_get_monitor_comm_fd` | `sshd_recon` | 1 | 2025-11-24 (SR3) – renamed the monitor/libc pointers, documented the zero-length read probe + fallback, and added inline comments for each branch. |
| `107D50_sshd_patch_permitrootlogin_usepam_and_hook_authpassword` | `sshd_recon` | 2 | 2025-12-17 (SR4) – retyped `use_pam_ptr` to `int *` so the exported C no longer emits a spurious `(uint *)` cast when patching sshd’s PAM flag; 2025-11-24 (SR4) – renamed the PermitRootLogin/PAM pointer temps, documented the skip/disable logic inline, and clarified how the monitor_reqtype fallback pulls from the live dispatch slot. |
| `107DE0_sshd_install_mm_log_handler_hook` | `sshd_recon` | 1 | 2025-11-24 (SR4) – retitled the handler/context slots, added inline notes for the privilege/logging gates, and described the filter-mode string checks before dropping the hook in place. |
| `107EA0_payload_stream_validate_or_poison` | `sshd_recon` | 1 | 2025-11-24 (SR4) – promoted the state-machine plate to plate+inline, renamed the total-length temp, and annotated the state 0/1/2 window plus the failure reset path. |
| `107F20_sshbuf_extract_rsa_modulus` | `sshd_recon` | 2 | 2025-12-17 (SR4) – clarified the 7-byte prefix scan, documented the “modulus reaches record tail” guard + mpint leading-zero trim with new inline anchors, and refreshed via the headless pipeline; 2025-11-24 (SR4) – renamed the sshbuf cursors and BE length temps, added inline comments for the certificate search and record-length validation, and documented the modulus pointer rewrite. |
| `108270_sshd_monitor_cmd_dispatch` | `sshd_recon` | 3 | 2025-12-17 (SR4) – renamed the 32-byte request-prefix scratch to `rsa_cert_alg_prefix`, clarified the exponent/modulus wording in AutoDoc, and refreshed via the headless pipeline; 2025-11-25 (SR4 revisit) – renamed the hashed-payload/sshbuf/BE length temps, added inline comments for the PermitRoot/PAM toggles, secret-data unwrap, sshbuf continuation, and wait drains, refreshed the AutoDoc, and reran the pipeline. |
| `108080_mm_answer_keyverify_send_staged_reply_hook` | `sshd_recon` | 1 | 2025-11-24 (SR5) – documented the staged keyverify reply/dispatch restore, renamed the locals to `sshd_ctx`, and added inline notes for the fd_write_full/exit guards. |
| `108100_mm_answer_authpassword_send_reply_hook` | `sshd_recon` | 2 | 2025-12-17 (SR5 revisit) – clarified the synthetic reply framing (reqtype + auth_ok + optional root_allowed) and renamed the stack temps in `metadata/xzre_locals.json`, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (SR5) – covered both the payload-backed and synthetic reply paths, renamed the sshd_ctx scratch, and dropped inline comments on the fatal guard and slot restore. |
| `108EA0_mm_answer_keyallowed_payload_dispatch_hook` | `sshd_recon` | 2 | 2025-12-17 (SR5 follow-up) – renamed the unused local shadowing `global_ctx` to `global_ctx_ptr` so the exported C no longer emits `::global_ctx` (while keeping the sshbuf_extract_ptr_and_len/decrypt inline anchors stable), then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (SR5) – expanded the state-machine AutoDoc, added inline comments for the type1/2/3 payload branches plus decrypt/signature checks, and synced the locals metadata. |
| `10A3A0_mm_log_handler_hide_auth_success_hook` | `sshd_recon` | 2 | 2025-11-25 (SR5 revisit) – expanded the plate to cover both pass-through and Accepted rewrites, added inline anchors for the string-id scans, fragment copies, sshd_log_via_sshlogv replays, and setlogmask toggles, and renamed the remaining loop/copy temps in `metadata/xzre_locals.json`. |
| `108D50_payload_stream_decrypt_and_append_chunk` | `sshd_recon` | 2 | 2025-11-26 (SR5 revisit) – renamed the ciphertext cursor/buffer append temps, added inline anchors for the state-3 short-circuit, header copy, length/buffer guards, and kept the double-decrypt reasoning in sync with metadata. |
| `102770_restore_ldso_audit_state` | `loader_rt` | 2 | 2025-12-17 (LR1 revisit) – corrected the AutoDoc to reflect how cleanup resets libcrypto’s `link_map::l_name` pointer away from the forged basename buffer (back to the auditstate slot address), then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (LR1) – renamed the bindflag/audit scratch temps, added inline comments for each reset (`l_name`, auditstate, `_dl_*`), and refreshed the AutoDoc to spell out how ld.so is restored. |
| `1027D0_hooks_ctx_init_or_wait_for_shared_globals` | `loader_rt` | 1 | 2025-11-24 (LR1) – retitled the status scratch to `init_status`, documented the hooks_data publication and 0x65 retry semantics, and wired inline notes into the exported C. |
| `102850_init_backdoor_shared_globals` | `loader_rt` | 1 | 2025-11-24 (LR1) – renamed the status temp, annotated how the shared block publishes the authpassword/RSA hooks + `global_ctx`, and upgraded the AutoDoc to plate+inline form. |
| `102890_libcrypto_imports_ready_or_install_bootstrap` | `loader_rt` | 1 | 2025-11-24 (LR1) – promoted the AutoDoc to plate+inline, added commentary around the 0x1d import count gate plus the fallback trampolines, and confirmed the exported C mirrors the metadata. |
| `102B10_sshd_validate_log_handler_slots` | `loader_rt` | 3 | 2025-12-17 (LR1 revisit) – added an inline note for the on-stack decoder scratch wipe and retyped `lea_insn_size` as `u64` to make the post-LEA pointer math clearer, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (LR7) – converted the scan-range wipes to explicit `u32` stores, refreshed the inline anchors for the pointer-gap/LEA/MOV guards, and re-ran the pipeline so the exported C matches the metadata updates. |
| `103F60_cache_cpuid_gotplt_slot_index` | `loader_rt` | 2 | 2025-12-17 (LR2 revisit) – clarified the plate/inline wording to treat the constant as the cpuid `.got.plt` slot index used by stage one, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (LR2) – promoted the AutoDoc to plate+inline form and added the inline note on the relocation constant so the cpuid slot index copy is obvious in `xzregh/103F60`. |
| `103F80_seed_got_ctx_for_tls_get_addr_parse` | `loader_rt` | 2 | 2025-12-17 (LR2 revisit) – reworded the 0x2600 seed as an `ff 25` opcode tag (0x25ff+1) rather than a GOT index, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (LR2) – renamed the return temp to `seeded_offset`, documented the sentinel 0x2600 write + GOT-base mirroring inline, and refreshed the metadata so the helper explains why the fake `__tls_get_addr` constants exist. |
| `103FA0_resolve_gotplt_base_from_tls_get_addr` | `loader_rt` | 2 | 2025-12-17 (LR2 revisit) – renamed the prefix/offset scratch (`has_endbr64_prefix`, `jmp_opcode_offset`, `gotplt_base`) and corrected the inline docs to explain how the PLT stub yields the `.got.plt` base (disp32 \u2212 0x18), then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (LR2) – renamed the PLT/disp locals (`tls_get_addr_stub`, `has_long_jump_prefix`, `stub_disp_offset`, `resolved_tls_entry`) and added inline comments covering each branch of the stub disassembly so the GOT math is easy to follow. |
| `104010_cache_got_base_offset_from_cpuid_anchor` | `loader_rt` | 2 | 2025-12-17 (LR2 revisit) – clarified that `got_base_offset` is the baseline constant used to derive the `.got.plt` base from the `cpuid_random_symbol` anchor, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (LR2) – expanded the AutoDoc/inline note around the `_Llzma_block_buffer_decode_0` write so the GOT baseline refresh is captured in metadata. |
| `104080_find_link_map_l_name_offsets` | `loader_rt` | 2 | 2025-12-17 (LR2 revisit) – renamed the name-pointer heuristics locals (`best_name_ptr`, `candidate_name_ptr`, etc.) and rewrote the plate/inline docs to describe the RELRO-anchored `l_name` offset recovery used by the ld.so audit scan, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (LR2) – renamed the link-map trackers (`snapshot_cursor`, `best_runtime_map`, etc.), threaded inline comments through the import resolution, RELRO match, and dual-LEA verification, and synced everything via the pipeline. |
| `104370_find_dl_naudit_slot` | `loader_rt` | 4 | 2025-12-18 (LR3 revisit) – simplified the decoder-context wipe cursor advance (dropped the zero-multiplied stride) via `metadata/xzre_locals.json` replacement so the exported loop reads as a straight 0x16-dword clear; 2025-12-17 (inline-match fix) – updated the stale `rex` inline-match anchor to the `prefix.modrm_bytes.rex_byte` form so the REX.W/range filter comment re-applies cleanly after refreshing; 2025-11-27 (LR7) – tightened the decoder reset to emit typed wipes, added a fresh inline anchor for the `_dl_audit_symbind_alt` scan kick-off, and kept the GLRO literal/mask commentary synced after rerunning the pipeline. |
| `1045E0_resolve_libc_read_errno_imports` | `loader_rt` | 1 | 2025-11-24 (LR3) – expanded the plate around the fake allocator bootstrap, added inline notes for the `elf_info_parse` sanity check, resolver allocs, and success gate, and synced the locals metadata so the two import slots read clearly. |
| `104660_scan_link_map_and_init_shared_libs` | `loader_rt` | 1 | 2025-11-24 (LR3) – renamed the SONAME/classifier temps, captured the SONAME hashing + ld.so validation path, and annotated the liblzma hooks-blob carve out plus the libc import resolver hand-off. |
| `104A40_scan_shared_libraries_via_r_debug` | `loader_rt` | 2 | 2025-12-18 (LR3 revisit) – corrected the `_r_debug` docs to key off `r_version` (not `r_state`) and added postprocess rewrites in `metadata/xzre_locals.json` so the exported C seeds/uses the stack `tmp_state` instead of the misleading `r_debug_sym`/`debug_block` temporaries; 2025-11-24 (LR3) – described the `_r_debug` lookup, scratch-state copy, and success propagation; inline comments now call out the `r_state` guard and the map-walker invocation that keeps the caller’s struct pristine. |
| `104AE0_find_l_audit_any_plt_mask_and_slot` | `loader_rt` | 3 | 2025-12-18 (LR3 revisit) – simplified the decoder-context wipe cursor advance (removed the zero-multiplied stride) via `metadata/xzre_locals.json` replacement so the exported loop reads as a straight 0x16-dword clear; 2025-11-27 (LR7) – replaced the `undefined*` wipes/register writes with typed metadata rewrites, kept the LEA/MOV/TEST state-machine inline notes current, and re-exported the C after the fresh inline match landed cleanly. |
| `104EE0_find_l_audit_any_plt_mask_via_symbind_alt` | `loader_rt` | 3 | 2025-12-18 (LR4) – rewrote the opcode overlay (`insn_ctx._40_4_` → `*(u32 *)&insn_ctx.opcode_window[3]`), collapsed the constant-zero wipe strides, and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (LR7) – rewrote the decoder/search-context wipes to use `u32` stores, documented the LEA-triggered zeroing loop inline, and synced the metadata so the helper no longer emits `undefined*` casts in `xzregh/104EE0`. |
| `1051E0_resolve_ldso_audit_offsets` | `loader_rt` | 2 | 2025-12-18 (LR4) – renamed `ldso_ctx_t::_unknown1459` to `libcrypto_basename_buf`, corrected the basename-length inline note, removed the zero-multiplied wipe stride via metadata replacements, and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (LR4) – Clarified the ld.so audit walk, renamed the libcrypto basename buffer/allocator temps, and added inline comments for the `_dl_audit_symbind_alt` lookup, `find_link_map_l_name_offsets` handoff, and libname copy. |
| `105830_backdoor_install_runtime_hooks` | `loader_rt` | 4 | 2025-12-18 (LR4) – added inline anchors for the hooks-data struct wipes, renamed the cached libcrypto basename buffer in `ldso_ctx_t`, collapsed the constant-zero wipe strides, and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (LR4 revisit) – Renamed the packed string-id scratch qwords, added inline anchors for the mm_request literal caching + relocation hunt, documented the fake `malloc_usable_size` stub and sshlogv handover, and reran the refresh to land the new metadata. |
| `106F30_cpuid_ifunc_stage2_install_hooks` | `loader_rt` | 3 | 2025-11-27 (LR7) – polished the CPUID fallback by renaming the register snapshot pointer, replacing the `undefined4` casts with `u32` rewrites, and adding a new inline anchor for the cpuid leaf-1 capture before rerunning the loader pipeline. |
| `10A794_cpuid_ifunc_patch_got_for_stage2` | `loader_rt` | 2 | 2025-11-27 (LR7) – retyped the relocation-constant pointer (`cpuid_reloc_consts`), documented the resolver-frame stash inline, and re-exported the IFUNC stub so the cpuid GOT swap no longer relies on `undefined*` casts. |
| `10A720_cpuid_ifunc_resolver_entry` | `loader_rt` | 2 | 2025-12-18 (LR5 revisit) – fixed the CPUID out-arg naming/order (`cpuid_ecx` vs `cpuid_edx`) and rewrote the last `cpuid_query_and_unpack` pointer away from `(uint *)&state` to a dedicated `cpuid_edx` scratch so the exported call reads cleanly; 2025-11-24 (LR5) – renamed the cpuid scratch registers, documented the second-call bootstrap, and added inline notes for the `cpuid_ifunc_patch_got_for_stage2` handoff plus the final `cpuid_query_and_unpack` dispatch. |
| `10A800_get_cpuid_modified` | `loader_rt` | 1 | 2025-11-24 (LR5) – clarified the high-bit probe/max-leaf gate, updated the AutoDoc to ASCII, and added inline anchors for the resolver call, bounds check, and success return. |
| `10A700_cpuid_gcc` | `loader_rt` | 2 | 2025-12-18 (LR5 revisit) – corrected the AutoDoc to describe the real `cpuid` instruction (Ghidra leaf pseudo-functions), renamed the tuple temps (`leaf_edx/leaf_ecx`), and updated the signature parameter names to `eax/ebx/ecx/edx`; 2025-11-24 (LR5) – captured the helper ladder vs. raw `cpuid()` fallback, highlighted the GCC register ordering inline, and kept the dispatcher locals in sync with metadata. |
| `1074B0_count_null_terminated_ptrs` | `loader_rt` | 2 | 2025-12-18 (LR5 revisit) – replaced the decompiler’s pointless `(int)` truncation in the `probe_index` increment with a straight `+ 1` via locals postprocessing; 2025-11-24 (LR5) – renamed the malloc-derived counters, explained the pointer-table heuristics, and added inline comments for the guard, NULL terminator break, and allocation-cap fallback. |
| `backdoor_hooks_data_blob` | `loader_rt` | 1 | 2025-11-21 – Authored the missing AutoDoc so the liblzma data blob is documented as the shared hooks state (`ldso_ctx_t`, `global_ctx`, resolved imports, sshd/log metadata, payload queues). |
| `107030_strlen_unbounded` | `loader_rt` | 1 | 2025-11-24 (LR6) – renamed the byte counter to `bytes_counted`, promoted the AutoDoc to plate+inline, and added inline anchors for the empty-string fast path and scan loop. |
| `107050_strnlen_bounded` | `loader_rt` | 1 | 2025-11-24 (LR6) – renamed the bounded counter to `bytes_checked`, documented the unterminated-path return value, and added inline comments for the zero-cap/terminator exits. |
| `107080_fd_read_full` | `loader_rt` | 2 | 2025-12-18 (LR6 revisit) – renamed the per-call read/errno/remaining temps (`bytes_read`, `errno_ptr`, `bytes_remaining`), added inline anchors for the zero-count fast path plus the `-1` collapse point, and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (LR6) – retitled the chunk/errno/remaining temps, expanded the plate with the EINTR + EOF semantics, and dropped inline anchors for the guard, retry loop, and pointer advance. |
| `1070F0_fd_write_full` | `loader_rt` | 2 | 2025-12-18 (LR6 revisit) – renamed the per-call write/errno/remaining temps (`bytes_written`, `errno_ptr`, `bytes_remaining`), added inline anchors for the zero-count fast path plus the `-1` collapse point, and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (LR6) – mirrored the new names, documented the fatal short-write behavior, and added inline comments for the EINTR retry gate plus the buffer/remaining updates. |
| `107170_pointer_array_has_null` | `loader_rt` | 2 | 2025-12-18 (LR6 revisit) – renamed the pointer-slot scratch to `slot_ptr`, updated the inline match string accordingly, and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (LR6) – renamed the slot/index temps, clarified the TRUE/FALSE exit criteria, and added inline anchors for the loop bound and NULL-hit return. |
| `103B80_dsa_pubkey_sha256_fingerprint` | `crypto_cmd` | 2 | 2025-12-18 (CC1 revisit) – clarified the scratch-buffer wipe split (word loop + explicit 16-byte head clear) in AutoDoc so the exported zeroization reads as a full wipe; refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (CC1) – renamed the scratch arrays (`fingerprint_stream`, `wipe_words`, `bn_components`) and added inline notes for the zeroize loop, pqg+y harvesting, per-component `bignum_mpint_serialize`, and final sha256_digest. |
| `107190_chacha20_decrypt` | `crypto_cmd` | 1 | 2025-11-24 (CC1) – retitled `outl` → `bytes_written` and threaded inline anchors through the pointer_array_has_null gate, EVP init/update/final calls, and the success/failure cleanup paths. |
| `1072B0_sha256_digest` | `crypto_cmd` | 1 | 2025-11-24 (CC1) – renamed the unused `md` spill, documented the input/size/import guard, and added inline comments for the EVP_Digest lookup plus the final hashing call. |
| `107320_bignum_mpint_serialize` | `crypto_cmd` | 1 | 2025-11-24 (CC1) – documented the buffer/bit-length guard, the BN_bn2bin copy, the top-bit padding branch, and the len-header write so the canonical `[len||value]` framing is obvious in-line. |
| `107510_rsa_pubkey_sha256_fingerprint` | `crypto_cmd` | 3 | 2025-12-18 (CC1 revisit) – rewrote the wipe cursor base to `fingerprint_stream + 0x10` via locals postprocessing and clarified the head/tail split in AutoDoc; refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (CC6) – rewrote the stack zeroization loop via the locals metadata so it emits typed `u8` stores/pointer bumps and reran the refresh to land the clean wipe plus inline coverage; 2025-11-24 (CC1) – renamed the stack wipes (`scratch_wipe_cursor`, `fingerprint_bytes/fingerprint_stream`) and annotated the exponent/modulus serialization sequence plus the final sha256_digest fingerprint. |
| `107630_verify_ed448_signed_payload` | `crypto_cmd` | 3 | 2025-12-18 (CC2 revisit) – rewrote the digest-scratch wipe loop to store an explicit zero byte (vs. the decompiler’s constant `signed_data_size < tbs_len` bool store) via locals postprocessing and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (CC6) – removed the lingering `undefined4` pointer hop in the digest wipe, documented both the elliptic-curve and Ed25519 scratch resets inline, and refreshed the exports via the headless pipeline; 2025-11-24 (CC2) – renamed the fingerprint wipe/loop temps, clarified the RSA/DSA/ECDSA/Ed25519 fingerprint paths, and added inline anchors for the sha256_digest splice plus Ed448 verify. |
| `107A20_sshd_find_forged_modulus_sshbuf` | `crypto_cmd` | 2 | 2025-12-18 (CC2 revisit) – renamed the pkex scan end pointer (`pkex_scan_end`), expanded the plate around the 0x400-byte scan, and added inline anchors for the monitor pkex_table dword override + the direct kex-slot `sshbuf_extract_ptr_and_len` path; refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (CC2) – retitled the pkex cursors/probe flags, documented the offset override vs. brute-force scan, and added inline comments for the banner hits + negative-bignum gate. |
| `107920_sshbuf_is_negative_mpint` | `crypto_cmd` | 1 | 2025-11-24 (CC2) – renamed the boolean/index locals and documented the size window plus MSB scan so the modulus predicate is obvious inline. |
| `107950_sshbuf_extract_ptr_and_len` | `crypto_cmd` | 2 | 2025-12-18 (CC2 revisit) – added an inline anchor for the `sshbuf_size_qword_index` selection (direct `buf->size` vs. offset read) and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (CC2) – renamed the slot indices/span cursor, explained the dynamic field lookup in the plate, and added inline notes for the struct/data range probes. |
| `1081D0_secret_data_decrypt_with_embedded_seed` | `crypto_cmd` | 2 | 2025-11-27 (CC6) – retyped the seed/IV wipe to `u32` stores, added a new inline anchor for the 0x70-byte seed_block scrub, and reran the refresh so the ChaCha setup no longer emits `undefined4`; 2025-11-24 (CC2) – renamed the ChaCha wipe/seed buffers and documented the two-stage decrypt with inline anchors for the zeroization + both `chacha20_decrypt` calls. |
| `1094A0_rsa_backdoor_command_dispatch` | `crypto_cmd` | 6 | 2025-12-18 (CC3 revisit) – eliminated the last lingering `undefined1` CONCAT cast by rewriting the `CONCAT31(...,(u8)sigcheck_result)` store via `metadata/xzre_locals.json`, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (CC3 revisit) – renamed the lingering `uVar*/bVar*/local_*` temps (opcode field packers, payload span counters, nonce/cmd_args/timespec scratch) via `metadata/xzre_locals.json`, added new inline anchors for the modulus-chunk clamp, PermitRootLogin override, and NUL-terminated `[uid||gid||cmd]` guard, and reran the refresh until `xzregh/1094A0` reflected the new names/comments without inline warnings; 2025-11-26 (CC3 pass) – renamed the remaining register temps (`control_flags`, `command_opcode`, `payload_chunk_len`, `caller_uid`, `command_payload_ptr`) plus the BN bit-length/fdset cursors, added inline anchors for the opcode scratch write, 0x87-byte body clamp, root-only gate, `[uid||gid||cmd]` length check, monitor payload sizing, and `pselect` socket wait, and reran the refresh so `xzregh/1094A0` shows the new comments without inline warnings. |
| `10A240_rsa_public_decrypt_backdoor_shim` | `crypto_cmd` | 1 | 2025-11-24 (CC3) – clarified the do_orig flag handling, renamed the dispatcher/OpenSSL status temps, and added inline comments for the pointer gate plus the dispatcher short-circuit. |
| `10A2D0_evp_pkey_set1_rsa_backdoor_shim` | `crypto_cmd` | 2 | 2025-12-18 (CC3 revisit) – seeded `do_orig_flag = TRUE` before calling rsa_backdoor_command_dispatch (matches the decrypt hook and avoids an uninitialised stack BOOL) via `metadata/xzre_locals.json`, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (CC3) – added locals coverage for the do_orig/status temps, documented the shim’s role, and dropped inline anchors for the pointer gate and tail-call. |
| `10A330_rsa_get0_key_backdoor_shim` | `crypto_cmd` | 2 | 2025-12-18 (CC3 revisit) – seeded `do_orig_flag = TRUE` before calling rsa_backdoor_command_dispatch (avoids the uninitialised local read smell) via `metadata/xzre_locals.json`, then refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-24 (CC3) – renamed the do_orig stub, captured the pointer gate, and documented how the hook feeds every modulus/exponent request into rsa_backdoor_command_dispatch. |
| `10A860_popcount_u64` | `crypto_cmd` | 1 | 2025-11-24 (CC3) – converted the entry to plate+inline form and added the Wegner-loop inline comment so the popcount helper is self-explanatory. |
| `10A880_encoded_string_id_lookup` | `crypto_cmd` | 1 | 2025-11-25 (CC4) – renamed the trie locals (`child_entry`, `child_rank`, etc.), documented the secret-data logging gate, bitmap rank/select math, and the signed child-delta walk directly in the exported C. |
| `10A990_secret_data_append_opcode_bit` | `crypto_cmd` | 2 | 2025-12-18 (CC4 revisit) – corrected the opcode filter write-up (MOV/CMP + ALU mask) and clarified that the bitstream lands in `global_ctx->encrypted_secret_data`; refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-25 (CC4) – renamed the cursor/opcode temps, captured the 0x1c8-bit guard + opcode mask inline, and documented how each decoded instruction flips the packed secret-data bit before advancing the cursor. |
| `10AA00_secret_data_append_code_bits` | `crypto_cmd` | 3 | 2025-12-18 (CC4 revisit) – clarified the `start_from_call` inline anchor wording (fast-forward to after the next CALL) and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (CC6) – patched the decoder zeroization loop via metadata so the exported wipe uses `u32` stores instead of `undefined4` casts and confirmed the inline scan commentary stayed stable after the refresh; 2025-11-25 (CC4) – renamed the decoder scratch (`ctx_wipe_cursor`, `cursor_work`, `bits_appended`), added inline anchors for the CALL fast-forward, reg-to-reg scan, and cursor advance, and refreshed the AutoDoc around the shift_count contract. |
| `10AAC0_secret_data_append_singleton_bits` | `crypto_cmd` | 3 | 2025-12-18 (CC4 revisit) – aligned AutoDoc field naming with the struct docs (`shift_operation_flags`, `secret_bits_filled`) and refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-27 (CC6) – retyped the shift-operation latch to `u8` so the exported guard no longer prints `undefined1` and updated the inline anchor before rerunning the refresh; 2025-11-25 (CC4) – renamed the singleton guard temps, documented the `global_ctx->shift_operations` byte, find_function_bounds bounds lookup, and `call_site`-driven scan before recording the global bit count. |
| `10AB70_secret_data_append_item_if_enabled` | `crypto_cmd` | 1 | 2025-11-25 (CC4) – clarified the descriptor gate so index 0 entries short-circuit, and inlined the singleton delegation path used by active slots. |
| `10AB90_secret_data_append_bits_from_addr_or_ret` | `crypto_cmd` | 2 | 2025-12-18 (CC5 revisit) – clarified that NULL vs `(void *)1` selects the singleton’s start-from-call behaviour while both reuse the caller’s return address; refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-25 (CC5) – documented the NULL/1 sentinel path, renamed the call-site/code-pointer temps, and added inline comments covering the singleton hop plus boolean normalization. |
| `10ABC0_secret_data_append_bits_from_call_site` | `crypto_cmd` | 1 | 2025-11-25 (CC5) – clarified how unaff_retaddr feeds the singleton helper, renamed the temps, and annotated the forced NULL call_site + bypass OR logic. |
| `10ABE0_secret_data_append_items_batch` | `crypto_cmd` | 2 | 2025-12-18 (CC5 revisit) – rewrote the plate/inline to match the actual `ordinal == 0` stamp-and-skip behaviour and clarified the 1-based array index passed to the callback; refreshed via `./scripts/refresh_xzre_project.sh`; 2025-11-25 (CC5) – renamed the descriptor/ordinal cursors, refreshed the plate to describe the nested scan, and threaded inline comments through each branch of the batch walker. |
